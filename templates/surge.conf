#!MANAGED-CONFIG {{generateUrl}} interval=43200 strict=false

[General]
loglevel = notify
bypass-system = true
skip-proxy = 127.0.0.1,192.168.0.0/16,10.0.0.0/8,172.16.0.0/12,100.64.0.0/10,localhost,*.local,e.crashlytics.com,captive.apple.com,::ffff:0:0:0:0/1,::ffff:128:0:0:0/1
bypass-tun = 192.168.0.0/16,10.0.0.0/8,172.16.0.0/12
dns-server = system,119.29.29.29,223.5.5.5
allow-wifi-access = false
wifi-access-http-port = 7222
wifi-access-socks5-port = 7221
proxy-test-url = http://www.gstatic.com/generate_204
test-timeout = 5
interface = 0.0.0.0
socks-interface = 0.0.0.0
exclude-simple-hostnames = true
ipv6 = false
network-framework = false
http-listen = 0.0.0.0:7222
socks5-listen = 0.0.0.0:7221
experimental = false

[Proxy]
# 节点信息
{{proxies}}

[Proxy Group]
# 策略组
Proxy = select, Auto, {{proxyNames}}
Auto = url-test, {{proxyNames}}, url=http://www.gstatic.com/generate_204, interval=300, tolerance=50

# 分流策略组
Global = select, Proxy, DIRECT
Apple = select, DIRECT, Proxy
Streaming = select, Proxy, DIRECT, {{proxyNames}}
StreamingSE = select, DIRECT, Proxy, {{proxyNames}}

[Rule]
# 基础规则
RULE-SET,SYSTEM,DIRECT
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Guard/Advertising.list,REJECT
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Guard/Hijacking.list,REJECT
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Guard/Privacy.list,REJECT

# 流媒体规则
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/StreamingMedia/Streaming.list,Streaming
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/StreamingMedia/StreamingSE.list,StreamingSE

# 全球规则
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Global.list,Global

# 苹果服务
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Extra/Apple/Apple.list,Apple

# 中国直连
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/China.list,DIRECT

# GeoIP China
GEOIP,CN,DIRECT

# Final
FINAL,Global,dns-failed

[Host]
localhost = 127.0.0.1

[URL Rewrite]
^https?://(www.)?g.cn https://www.google.com 302
^https?://(www.)?google.cn https://www.google.com 302

[MITM]
skip-server-cert-verify = true
hostname = *.googlevideo.com
ca-passphrase = {{random}}
ca-p12 = {{random}}
